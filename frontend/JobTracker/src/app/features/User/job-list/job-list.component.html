<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>Company</th>
        <th>Position</th>
        <th>Applied Date</th>
        <th>Status</th>
        <th>Link</th>
        <th>Salary Exp.</th>
        <th>Notes</th>
        <th>Interviews</th>
        <th>Offer</th>
        <th class="text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      @for (application of applications; track application.id) {
      <tr>
        <td class="fw-bold">{{ application.company }}</td>
        <td>{{ application.position }}</td>
        <td>{{ application.appliedDate | date : "mediumDate" }}</td>

        <td>
          <span class="status-badge">{{ application.currentStatus }}</span>
        </td>

        <td>
          @if (application.jobUrl) {
          <a
            [href]="application.jobUrl"
            target="_blank"
            class="link-icon"
            title="Open Job Posting"
          >
            <i class="fa-solid fa-external-link-alt"></i> Open
          </a>
          } @else {
          <span class="text-muted">-</span>
          }
        </td>

        <td>{{ application.salaryExpectation | currency }}</td>
        <td class="notes-cell" [title]="application.notes">
          {{ application.notes }}
        </td>
        <td class="text-center">{{ application.interviewCount }}</td>

        <td class="text-center">
          @if (application.offerStatus === 'Received') {
          <span class="badge-success">
            <i class="fa-solid fa-check"></i> Recorded
          </span>
          } @else if (application.currentStatus === 'OfferReceived' &&
          application.offerStatus === 'Pending') {
          <a
            [routerLink]="['/user/offers/add']"
            [queryParams]="{ jobId: application.id }"
            class="btn-sm-action"
            title="Add the offer details now"
          >
            <i class="fa-solid fa-plus"></i> Add Details
          </a>
          }@else if (application.currentStatus === 'Interviewing' &&
          application.offerStatus === 'Pending') {
          <span class="text-muted">Pending</span>
          } @else {
          <span class="text-muted">-</span>
          }
        </td>

        <td class="text-center">
          <a
            [routerLink]="['/user/jobs/edit', application.id]"
            class="icon-btn edit-btn"
            title="Edit Application"
          >
            <i class="fa-solid fa-pen-to-square"></i>
          </a>

          <button
            class="icon-btn delete-btn"
            (click)="onDelete(application.id)"
            title="Delete Application"
          >
            <i class="fa-solid fa-trash"></i>
          </button>
        </td>
      </tr>
      } @empty {
      <tr>
        <td colspan="10" class="empty-state">
          No applications found.
          <a routerLink="/user/jobs/add">Add your first job!</a>
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>

<a routerLink="/user/jobs/add" class="fab-btn" title="Add New Job">
  <i class="fa-solid fa-plus"></i>
</a>
